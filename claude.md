# Free Canvas 项目开发指导

## 项目概述
基于 Tldraw 构建的自由白板应用，支持自定义工具和扩展功能。项目采用 React + TypeScript + Vite 技术栈，提供可扩展的绘图和协作平台。

## 技术栈
- **Tldraw 4.2.0** - 主要绘图引擎
- **React 18.3.1** + **TypeScript 5.8.3** - 开发框架
- **Vite 7.0.1** - 构建工具
- **Tailwind CSS 4.1** + **Lucide React** - UI框架和图标

## 开发原则
- **文档优先**：不熟悉的技术先查官方文档，使用 context7 搜索最新API
- **架构设计**：理解技术边界后再设计实现方案，避免盲目尝试
- **代码质量**：TypeScript + React Hooks + 事件处理优化

## 核心开发模式

项目基于 Tldraw 的插件化架构，支持自定义工具和形状扩展。具体实现模式请参考相关代码文件中的详细注释。

## 项目结构
```
src/
├── App.tsx                    # 主应用
├── components/                # 通用组件
│   ├── CustomToolbar.tsx      # 自定义工具栏
│   └── KeyboardHandler.tsx    # 键盘快捷键
├── tools/                     # 自定义工具
│   ├── FinalWebContainer.tsx  # 网页容器形状
│   └── WebContainerToolUtil.tsx # 工具状态管理
└── utils/                     # 工具函数
    └── ToolManager.tsx         # 工具管理器
```

## 开发流程
1. 查阅相关文档 → 2. 理解技术边界 → 3. 设计架构 → 4. 实现测试 → 5. 优化完善

## 开发行为要求

### 代码质量标准
- **注释规范**: 复杂逻辑必须有中文注释，说明实现思路和关键步骤
- **命名清晰**: 使用语义化的变量名、函数名和组件名
- **类型安全**: 充分利用TypeScript类型系统，避免any类型
- **错误处理**: 边界条件和异常情况要有适当处理

### 文件组织原则
- **单一职责**: 每个文件只负责一个明确的功能模块
- **合理拆分**: 避免超长文件，超过200行考虑拆分
- **逻辑分层**: UI组件、业务逻辑、数据管理清晰分离
- **依赖管理**: 避免循环依赖，保持清晰的模块依赖关系

### 架构设计要求
- **组件化优先**: 优先设计可复用的组件，提高代码利用率
- **状态管理**: 合理使用React Hooks，避免不必要的重渲染
- **事件处理**: 正确处理事件冒泡和阻止，避免功能冲突
- **性能考虑**: 大数据处理、频繁操作要有性能优化意识

### AI协作规范
- **代码可读性**: 保持代码结构清晰，便于AI理解和分析
- **文档同步**: 重大功能更新要同步更新相关文档
- **版本控制**: 合理规划commit粒度和信息描述
- **测试覆盖**: 关键功能要有相应的测试用例

## 扩展方向
- **工具生态**: 构建可扩展的工具体系，支持第三方工具
- **平台能力**: 协作同步、版本管理、权限控制
- **用户体验**: 配置面板、模板库、快捷操作

## 重要要求
**不要在代码、文档、git提交信息中特意写出AI助手相关信息**

## 开发笔记管理

开发过程中的经验教训和技术解决方案记录在 [`dev-notes/`](dev-notes/) 文件夹中，包括：

- **实现详解**：重要功能的完整实现过程（如 [WebContainer 实现](dev-notes/webcontainer-implementation.md)）
- **踩坑记录**：常见错误和解决方案
- **API 参考**：库和框架的使用经验
- **架构决策**：技术选型和设计思路

鼓励在解决复杂问题后添加笔记，记录问题背景、解决方案、关键代码和注意事项。

---

**开发提示**：遇到技术问题时，优先使用 context7 搜索相关文档，理解技术细节后再进行实现。